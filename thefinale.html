<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ”¥ Ultra Instinct Typing</title>
  <style>
    html, body {
      margin: 0;
      background: #0d0d0d;
      font-family: monospace;
      overflow: hidden;
      color: white;
    }

    body.shake {
      animation: shake 0.3s;
    }

    @keyframes shake {
      0% { transform: translate(2px, 2px); }
      25% { transform: translate(-2px, -4px); }
      50% { transform: translate(-4px, 4px); }
      75% { transform: translate(4px, -2px); }
      100% { transform: translate(0, 0); }
    }

    .glitch {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,0,0,0.1) 3px);
      mix-blend-mode: screen;
      animation: glitchAnim 0.2s infinite;
      pointer-events: none;
      z-index: 99;
    }

    @keyframes glitchAnim {
      0% { transform: translate(0, 0); opacity: 1; }
      50% { transform: translate(2px, -2px); opacity: 0.4; }
      100% { transform: translate(-1px, 1px); opacity: 1; }
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1;
      pointer-events: none;
    }

    textarea {
      background: #111;
      color: #0f0;
      font-size: 1.2rem;
      border: none;
      padding: 1rem;
      width: 80%;
      height: 200px;
      resize: none;
      outline: none;
      box-shadow: 0 0 10px lime;
      margin-top: 2rem;
      z-index: 2;
    }

    .output {
      margin-top: 1rem;
      width: 80%;
      color: #0ff;
      min-height: 2rem;
      white-space: pre-wrap;
    }

    .controls {
      position: absolute;
      top: 1rem;
      left: 1rem;
      background: #222;
      padding: 1rem;
      border-radius: 10px;
      z-index: 10;
    }

    .face {
      position: fixed;
      top: 1rem;
      right: 1rem;
      display: flex;
      gap: 1rem;
      z-index: 10;
    }

    .eye {
      width: 60px;
      height: 60px;
      background: white;
      border-radius: 50%;
      position: relative;
    }

    .pupil {
      width: 20px;
      height: 20px;
      background: black;
      border-radius: 50%;
      position: absolute;
      top: 20px;
      left: 20px;
      transition: top 0.05s, left 0.05s;
    }

    .fire {
      position: absolute;
      width: 50px;
      height: 50px;
      background: url('https://media.giphy.com/media/l0HlQ7LRalfoyJzDi/giphy.gif') no-repeat center;
      background-size: contain;
      pointer-events: none;
      z-index: 20;
    }

    .typewriter {
      margin-top: 3rem;
      width: 90%;
      height: 200px;
      background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Olivetti_Lettera_22.jpg/640px-Olivetti_Lettera_22.jpg') no-repeat center;
      background-size: contain;
      background-position-y: bottom;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <canvas id="particles"></canvas>

  <div class="face">
    <div class="eye"><div class="pupil"></div></div>
    <div class="eye"><div class="pupil"></div></div>
  </div>

  <div class="controls">
    <label><input type="checkbox" id="bpmToggle" checked> BPM Sync</label><br>
    <label>BPM: <input type="number" id="bpmInput" value="120"></label>
  </div>

  <center>
    <textarea id="rageBox" placeholder="Type something epic..."></textarea>
    <div class="output" id="output"></div>
    <div class="typewriter"></div>
  </center>

  <script>
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let particles = [];

    function addParticles(x, y) {
      for (let i = 0; i < 10; i++) {
        particles.push({
          x, y,
          dx: (Math.random() - 0.5) * 6,
          dy: (Math.random() - 0.5) * 6,
          alpha: 1,
          radius: Math.random() * 4 + 2,
          color: `hsl(${Math.random() * 360}, 100%, 50%)`
        });
      }
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles = particles.filter(p => p.alpha > 0.01);
      particles.forEach(p => {
        p.x += p.dx;
        p.y += p.dy;
        p.alpha *= 0.95;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        ctx.fillStyle = `hsla(${Math.random() * 360}, 100%, 50%, ${p.alpha})`;
        ctx.fill();
      });
      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    const textarea = document.getElementById('rageBox');
    const output = document.getElementById('output');
    let queue = [];

    textarea.addEventListener('input', (e) => {
      const typed = e.data;
      if (typed) queue.push(typed);

      const x = textarea.getBoundingClientRect().left + 100;
      const y = textarea.getBoundingClientRect().top + 50;

      addParticles(x, y);
      if (typed === '\n') {
        const fire = document.createElement('div');
        fire.className = 'fire';
        fire.style.left = `${x}px`;
        fire.style.top = `${y}px`;
        document.body.appendChild(fire);
        setTimeout(() => fire.remove(), 1200);
      }

      if (typed && Math.random() > 0.8) shake();
    });

    setInterval(() => {
      if (queue.length > 0) {
        const char = queue.shift();
        output.textContent += char;
      }
    }, 20);

    function shake() {
      document.body.classList.add('shake');
      setTimeout(() => document.body.classList.remove('shake'), 300);
    }

    // Eyes track
    document.addEventListener('mousemove', (e) => {
      document.querySelectorAll('.eye').forEach(eye => {
        const pupil = eye.querySelector('.pupil');
        const rect = eye.getBoundingClientRect();
        const dx = e.clientX - (rect.left + 30);
        const dy = e.clientY - (rect.top + 30);
        const angle = Math.atan2(dy, dx);
        pupil.style.left = `${20 + Math.cos(angle) * 15}px`;
        pupil.style.top = `${20 + Math.sin(angle) * 15}px`;
      });
    });

    // BPM Glitch
    const bpmToggle = document.getElementById('bpmToggle');
    const bpmInput = document.getElementById('bpmInput');
    let bpmInterval;

    function glitch() {
      if (!bpmToggle.checked) return;
      shake();
      const glitchDiv = document.createElement('div');
      glitchDiv.className = 'glitch';
      document.body.appendChild(glitchDiv);
      setTimeout(() => glitchDiv.remove(), 300);
    }

    function startBPM() {
      clearInterval(bpmInterval);
      const bpm = parseInt(bpmInput.value);
      const interval = 60000 / bpm;
      bpmInterval = setInterval(glitch, interval);
    }

    bpmToggle.addEventListener('change', () => bpmToggle.checked ? startBPM() : clearInterval(bpmInterval));
    bpmInput.addEventListener('input', startBPM);
    startBPM();
  </script>
</body>
</html>
